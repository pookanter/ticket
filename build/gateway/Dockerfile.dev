
FROM cosmtrek/air AS builder

WORKDIR /app

COPY cmd cmd
COPY api/gateway api/gateway
COPY api/api.go api
COPY pkg pkg
COPY go.mod go.sum ./
COPY config config
COPY certs certs
COPY build/gateway ./

FROM cosmtrek/air AS runtime

WORKDIR /app

COPY --from=builder /app .
COPY --from=builder /app/.air.toml .

CMD ["air", "-c", ".air.toml"]